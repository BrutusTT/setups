####################################################################################################
# General Environment Variables
####################################################################################################
export JAVA_HOME=$(/usr/libexec/java_home)
export EDITOR=mcedit

export SOFTWARE=~/software
export SOFTWARE_BIN=$SOFTWARE/bin
export SOFTWARE_BUILD=$SOFTWARE/build
export SOFTWARE_GIT=$SOFTWARE/git
export SOFTWARE_ENV=$SOFTWARE/environments

export PATH=$SOFTWARE_BIN:/usr/local/bin:$PATH:/usr/local/sbin:

####################################################################################################
# Shortcuts for CLI tools
####################################################################################################
alias showFiles='defaults write com.apple.finder AppleShowAllFiles TRUE && killall Finder'
alias hideFiles='defaults write com.apple.finder AppleShowAllFiles FALSE && killall Finder'

alias la="ls -la"
alias netstat_osx="sudo lsof -i -P"
alias osxpython="/System/Library/Frameworks/Python.framework/Versions/2.7/bin/python"
alias ports='lsof -i -P | grep -i "listen"'
alias scp="rsync -avzP"		# rsync settings

alias brewup="brew update && brew upgrade --all"

# recursive update in git directory
alias gitup='for dir in $SOFTWARE_GIT/*; do (cd "$dir" && echo "$dir" && git pull); done'


####################################################################################################
# YARP/iCub Environment Variables
####################################################################################################
export YARP_DATA_DIRS=/usr/local/share/iCub:/usr/local/share/yarp
export YARP_ROBOT_NAME=iCubEdinburgh01
export ICUBcontrib_DIR=/usr/local/share/ICUBcontrib
export LUA_PATH=";;;$SOFTWARE_GIT/rFSM/?.lua;$ICUBcontrib_DIR/share/ICUBcontrib/contexts/iol/lua/?.lua"

export OPENNI2_INCLUDE=/usr/local/include/ni2
export OPENNI2_REDIST=/usr/local/lib/ni2
export NITE2_INCLUDE=$SOFTWARE_BIN/NiTE-MacOSX-x64-2.2/Include
export NITE2_REDIST64=$SOFTWARE_BIN/NiTE-MacOSX-x64-2.2/Redist

export ROBOT_CODE=$SOFTWARE_GIT
export YARP_ROOT=$ROBOT_CODE/yarp
export ICUB_ROOT=$ROBOT_CODE/icub-main
export ICUB_BUILD_PATHNAME="build"

if [ "$ICUB_BUILD_PATHNAME" != "" ]; then
    export YARP_DIR=$YARP_ROOT/$ICUB_BUILD_PATHNAME
    export ICUB_DIR=$ICUB_ROOT/$ICUB_BUILD_PATHNAME
    export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$ROBOT_CODE/icub-tests/suits/$ICUB_BUILD_PATHNAME/plugin
fi

# Debug Stream customization
export YARP_VERBOSE_OUTPUT=0
export YARP_COLORED_OUTPUT=1
export YARP_TRACE_ENABLE=0
export YARP_FORWARD_LOG_ENABLE=0

# Add YARP bash completion
if [ -f $YARP_ROOT/scripts/yarp_completion ]; then
    source $YARP_ROOT/scripts/yarp_completion
fi

####################################################################################################
# Robotic Shortcuts
####################################################################################################
alias startgrabber="yarpdev --device opencv_grabber "
alias startmary="cd $SOFTWARE_GIT/marytts-installer && marytts server"
alias startnao="/Applications/Choregraphe.app/Contents/Resources/bin/naoqi-bin"
alias pynao1="source $SOFTWARE_ENV/pynao1/bin/activate"
alias yarpclean="yarp clean --timeout 1.0"


####################################################################################################
# Utility functions
####################################################################################################

# password generator
genpasswd() {
    local l=$1
        [ "$l" == "" ] && l=16
        env LC_CTYPE=C tr -dc A-Za-z0-9_ < /dev/urandom | head -c ${l} | xargs
}

# return the program with the maximum number of open files
openfiles() {
    sudo lsof -n | perl -pe '$x = <>; while(<>) { ($cmd, $pid, $rest) = split(/\s+/); $cmds{$pid} = $cmd; $pids{$pid}++;} while( ($key, $val) = each %pids) { if ($val > $max) { $max = $val; $maxpid = $key; } } print "pid: $maxpid ($cmds{$maxpid}) has the most ($max) filedescriptors \n";'
}

# recursive grep in C++ files
searchc++() {
    grep -n -R "$1" --include=*.cpp --include=*.h *
}

# recursive grep in Python files
searchpy() {
    grep -n -R "$1" --include=*.py *
}

# recursive grep in Java files
searchjava() {
    grep -n -R "$1" --include=*.java *
}
